@startuml
title Overall system architecture - Torque DSL platform

actor User

package "Client" {
  [Web Browser] as Browser
}

package "Torque Web App\n(Streamlit)" {
  [Home Page\napp.py] as Home
  [Mapper Page\n0_mapper.py] as MapperUI
  [Runner Page\n2_test.py] as RunnerUI
  [Evolution Page\n3_evolution.py] as EvoUI
}

package "Core Engine" {
  [TorqueMapper\nTorque_mapper.py] as TM
  [TorqueRunner\nTorque_runner.py] as TR
  [Compiler\ncompiler.py] as Compiler
  [Registry\nregistry.py] as Registry
  [GE Algorithms\ngrape.algorithms] as GE
}

package "Configuration & Grammar" {
  [Mapper Config\nconfig/Torque_mapper_config.json] as MapperConfig
  [Runner Config\nconfig/Torque_runner_config.json] as RunnerConfig
  [Evolution Config\nconfig/evolution_config.json] as EvoConfig
  [BNF Grammar File\ngrammar/ensamble_grammar.bnf] as GrammarFile
  [Grammar Loader\ngrammar.py] as GrammarLoader
}

package "Data & Storage" {
  [Dataset Loader\ndataset_loader.py] as Loader
  [Local CSV Data\ndata/*.csv] as CSVData
  [UCI ML Repository] as UCI
  [Results\nresults/*] as Results
}

User --> Browser : open Torque app
Browser --> Home

Home --> MapperUI
Home --> RunnerUI
Home --> EvoUI

MapperUI --> TM
RunnerUI --> TR
EvoUI --> GE

TR --> TM
TM --> Compiler
Compiler --> Registry

MapperUI --> GrammarLoader
EvoUI --> GrammarLoader
GrammarLoader --> GrammarFile

RunnerUI --> Loader
EvoUI --> Loader
Loader --> CSVData
Loader --> UCI

TR --> Results
EvoUI --> Results

@enduml

