<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="939px" preserveAspectRatio="none" style="width:781px;height:939px;" version="1.1" viewBox="0 0 781 939" width="781px" zoomAndPan="magnify"><defs><filter height="300%" id="feg64ej4gs0hz" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="239" x="264.62" y="19.2419">Mapper system architecture</text><!--MD5=[406b65fecc21e832f7a9b6ebadc6dce1]
cluster Client--><polygon fill="#FFFFFF" filter="url(#feg64ej4gs0hz)" points="105.24,187.5158,151.24,187.5158,158.24,212.5838,267.24,212.5838,267.24,290.5158,105.24,290.5158,105.24,187.5158" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="105.24" x2="158.24" y1="212.5838" y2="212.5838"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="40" x="109.24" y="204.4818">Client</text><!--MD5=[6e0d427754a400b0d323ae1c0705a90d]
cluster Torque App (Streamlit)--><polygon fill="#FFFFFF" filter="url(#feg64ej4gs0hz)" points="313.24,178.0158,478.24,178.0158,485.24,203.0838,562.24,203.0838,562.24,465.0158,313.24,465.0158,313.24,178.0158" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="313.24" x2="485.24" y1="203.0838" y2="203.0838"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="159" x="317.24" y="194.9818">Torque App (Streamlit)</text><!--MD5=[d37ddcb5eec7baa119d04d740408a4bf]
cluster Mapper Core--><polygon fill="#FFFFFF" filter="url(#feg64ej4gs0hz)" points="185.24,516.0158,280.24,516.0158,287.24,541.0838,764.24,541.0838,764.24,932.0158,185.24,932.0158,185.24,516.0158" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="185.24" x2="287.24" y1="541.0838" y2="541.0838"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="89" x="189.24" y="532.9818">Mapper Core</text><!--MD5=[e9dede37b31fdda9664526f66258b036]
entity Browser--><rect fill="#FEFECE" filter="url(#feg64ej4gs0hz)" height="49.0679" style="stroke:#A80036;stroke-width:1.5;" width="129" x="121.74" y="225.5158"/><rect fill="#FEFECE" height="10" style="stroke:#A80036;stroke-width:1.5;" width="15" x="230.74" y="230.5158"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="228.74" y="232.5158"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="228.74" y="236.5158"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89" x="136.74" y="260.4818">Web Browser</text><!--MD5=[cfbf5bfb2284cb4360c7117782840247]
entity Home--><rect fill="#FEFECE" filter="url(#feg64ej4gs0hz)" height="68.1358" style="stroke:#A80036;stroke-width:1.5;" width="116" x="329.24" y="216.0158"/><rect fill="#FEFECE" height="10" style="stroke:#A80036;stroke-width:1.5;" width="15" x="425.24" y="221.0158"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="423.24" y="223.0158"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="423.24" y="227.0158"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76" x="344.24" y="250.9818">Home Page</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46" x="344.24" y="270.0497">app.py</text><!--MD5=[3058c7db85c12fcc63ae21611ef884f0]
entity MapperUI--><rect fill="#FEFECE" filter="url(#feg64ej4gs0hz)" height="68.1358" style="stroke:#A80036;stroke-width:1.5;" width="130" x="329.24" y="381.0158"/><rect fill="#FEFECE" height="10" style="stroke:#A80036;stroke-width:1.5;" width="15" x="439.24" y="386.0158"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="437.24" y="388.0158"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="437.24" y="392.0158"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="90" x="344.24" y="415.9818">Mapper Page</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87" x="344.24" y="435.0497">0_mapper.py</text><!--MD5=[c6ddddda358f072e4f19aa798de5fbe9]
entity TM--><rect fill="#FEFECE" filter="url(#feg64ej4gs0hz)" height="68.1358" style="stroke:#A80036;stroke-width:1.5;" width="167" x="310.74" y="554.0158"/><rect fill="#FEFECE" height="10" style="stroke:#A80036;stroke-width:1.5;" width="15" x="457.74" y="559.0158"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="455.74" y="561.0158"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="455.74" y="565.0158"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="101" x="325.74" y="588.9818">TorqueMapper</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="127" x="325.74" y="608.0497">Torque_mapper.py</text><!--MD5=[c01552aeb07e95759ece564214fd0bdc]
entity Compiler--><rect fill="#FEFECE" filter="url(#feg64ej4gs0hz)" height="68.1358" style="stroke:#A80036;stroke-width:1.5;" width="119" x="201.74" y="701.0158"/><rect fill="#FEFECE" height="10" style="stroke:#A80036;stroke-width:1.5;" width="15" x="300.74" y="706.0158"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="298.74" y="708.0158"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="298.74" y="712.0158"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="216.74" y="735.9818">Compiler</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79" x="216.74" y="755.0497">compiler.py</text><!--MD5=[4deb7753515de286d568fa33f0a2fe6f]
entity Registry--><rect fill="#FEFECE" filter="url(#feg64ej4gs0hz)" height="68.1358" style="stroke:#A80036;stroke-width:1.5;" width="112" x="356.24" y="701.0158"/><rect fill="#FEFECE" height="10" style="stroke:#A80036;stroke-width:1.5;" width="15" x="448.24" y="706.0158"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="446.24" y="708.0158"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="446.24" y="712.0158"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55" x="371.24" y="735.9818">Registry</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="371.24" y="755.0497">registry.py</text><!--MD5=[4e46ea923f25faeca3157dc85fae6288]
entity GrammarLoader--><rect fill="#FEFECE" filter="url(#feg64ej4gs0hz)" height="68.1358" style="stroke:#A80036;stroke-width:1.5;" width="154" x="550.24" y="701.0158"/><rect fill="#FEFECE" height="10" style="stroke:#A80036;stroke-width:1.5;" width="15" x="684.24" y="706.0158"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="682.24" y="708.0158"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="682.24" y="712.0158"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="114" x="565.24" y="735.9818">Grammar Loader</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83" x="565.24" y="755.0497">grammar.py</text><!--MD5=[7642f318d6d2a8288c8b08f01eada685]
entity GrammarFile--><rect fill="#FEFECE" filter="url(#feg64ej4gs0hz)" height="68.1358" style="stroke:#A80036;stroke-width:1.5;" width="202" x="526.24" y="848.0158"/><rect fill="#FEFECE" height="10" style="stroke:#A80036;stroke-width:1.5;" width="15" x="708.24" y="853.0158"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="706.24" y="855.0158"/><rect fill="#FEFECE" height="2" style="stroke:#A80036;stroke-width:1.5;" width="4" x="706.24" y="859.0158"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54" x="541.24" y="882.9818">BNF File</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="162" x="541.24" y="902.0497">ensamble_grammar.bnf</text><!--MD5=[fee662a292a0353a69bd162820bae93b]
entity User--><ellipse cx="186.24" cy="38.5158" fill="#FEFECE" filter="url(#feg64ej4gs0hz)" rx="8" ry="8" style="stroke:#A80036;stroke-width:1.5;"/><path d="M186.24,46.5158 L186.24,73.5158 M173.24,54.5158 L199.24,54.5158 M186.24,73.5158 L173.24,88.5158 M186.24,73.5158 L199.24,88.5158 " fill="none" filter="url(#feg64ej4gs0hz)" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="170.74" y="108.9818">User</text><!--MD5=[ec4c93e45963a154c97e3947d19a9663]
link User to Browser--><path d="M186.24,113.0658 C186.24,145.8558 186.24,190.9658 186.24,220.0658 " fill="none" id="User-to-Browser" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="186.24,225.3058,190.24,216.3058,186.24,220.3058,182.24,216.3058,186.24,225.3058" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="187.24" y="157.9129">navigate to Torque</text><!--MD5=[3938fcd18a2facc0c88cf7bda1beea46]
link Browser to Home--><path d="M250.95,250.0158 C274.31,250.0158 300.65,250.0158 323.89,250.0158 " fill="none" id="Browser-to-Home" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="329.11,250.0158,320.11,246.0158,324.11,250.0158,320.11,254.0158,329.11,250.0158" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26" x="276.99" y="242.9129">load</text><!--MD5=[560fc0e79cc73e814ebdbfce0f4a00a2]
link Home to MapperUI--><path d="M388.67,284.3958 C389.82,310.9658 391.41,348.1558 392.6,375.8958 " fill="none" id="Home-to-MapperUI" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="392.82,380.9558,396.431,371.7928,392.6059,375.9604,388.4383,372.1354,392.82,380.9558" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180" x="392.24" y="337.9129">switch_page(\"0_mapper.py\")</text><!--MD5=[bf0d92fe98f48d99f0aee9185276849c]
link Browser to MapperUI--><path d="M121.5,267.8258 C68.17,284.7958 6,313.7858 37.24,351.0158 C73.07,393.7258 230.27,407.4958 323.7,411.9258 " fill="none" id="Browser-to-MapperUI" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="328.93,412.1658,320.1221,407.759,323.9352,411.9375,319.7567,415.7507,328.93,412.1658" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="38.24" y="328.9129">enter Torque DSL</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="33" x="73.74" y="346.6189">click \</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133" x="188.3097" y="408.4232">Map to AST &amp; Python\</text><!--MD5=[154ba5a3dd69c69c34158c4570fd215a]
link MapperUI to Browser--><path d="M329.17,397.2958 C300.38,387.4358 267.61,372.5558 243.24,351.0158 C221.25,331.5758 205.73,301.5158 196.49,279.4358 " fill="none" id="MapperUI-to-Browser" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="194.51,274.5658,194.2013,284.4099,196.3965,279.1963,201.61,281.3915,194.51,274.5658" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95" x="264.74" y="328.9129">render AST tree,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136" x="244.24" y="346.6189">JSON and Python code</text><!--MD5=[8a4b2d88ea8873835b7ddf243bba20dd]
link MapperUI to TM--><path d="M361.44,449.1958 C354.02,458.7158 347.18,469.6258 343.24,481.0158 C335.09,504.6258 346.36,529.8658 360.37,549.7958 " fill="none" id="MapperUI-to-TM" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="363.39,553.9658,361.3274,544.3354,360.4474,549.9234,354.8594,549.0435,363.39,553.9658" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="53" x="344.24" y="495.9129">map DSL</text><!--MD5=[65c322052ddb7b8c9772bc0a56d6d9ea]
link TM to MapperUI--><path d="M399.1,553.6158 C401.56,532.7558 403.73,505.3358 402.24,481.0158 C401.72,472.4658 400.81,463.3158 399.79,454.6558 " fill="none" id="TM-to-MapperUI" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="399.14,449.3458,396.2504,458.7613,399.7408,454.3096,404.1925,457.8,399.14,449.3458" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="403.24" y="495.9129">AST + Python code</text><!--MD5=[3f9a8d62391aa6abb13038c418c98164]
link TM to GrammarLoader--><path d="M478.11,600.8458 C515.38,609.7058 557.64,625.1458 588.24,652.0158 C601.45,663.6058 610.55,680.6558 616.61,696.2058 " fill="none" id="TM-to-GrammarLoader" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="618.4,700.9758,618.9753,691.1438,616.6397,696.296,611.4875,693.9603,618.4,700.9758" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119" x="604.24" y="666.9129">get GRAMMAR_BNF</text><!--MD5=[66bc3ffa447e74f73a9b25e50d81d95e]
link GrammarLoader to GrammarFile--><path d="M627.24,769.2858 C627.24,791.2058 627.24,819.9658 627.24,842.8258 " fill="none" id="GrammarLoader-to-GrammarFile" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="627.24,847.9058,631.24,838.9058,627.24,842.9058,623.24,838.9058,627.24,847.9058" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="55" x="628.24" y="813.9129">read BNF</text><!--MD5=[6cfce05c7c8ad9275dc93027216b8976]
link TM to Compiler--><path d="M310.51,612.6758 C291.94,621.9258 274.47,634.6358 263.24,652.0158 C255.05,664.6958 253.3,680.9258 254.06,695.6058 " fill="none" id="TM-to-Compiler" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="254.45,700.9258,257.7967,691.663,254.0927,695.9386,249.8172,692.2346,254.45,700.9258" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116" x="264.24" y="666.9129">(for nested models)</text><!--MD5=[0461d29d1e4a900009b19b7f16b32e25]
link TM to Registry--><path d="M390.06,622.3158 C388.94,637.2858 388.66,655.1258 391.24,671.0158 C392.57,679.2158 394.82,687.7858 397.36,695.8758 " fill="none" id="TM-to-Registry" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="398.97,700.8458,399.9983,691.0508,397.4275,696.0897,392.3886,693.5189,398.97,700.8458" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="191" x="392.24" y="666.9129">resolve model/ensemble classes</text><!--MD5=[9228f56c7c152d9a7c3a89218c2a7ed2]
@startuml
title Mapper system architecture

actor User

package "Client" {
  [Web Browser] as Browser
}

package "Torque App (Streamlit)" {
  [Home Page\napp.py] as Home
  [Mapper Page\n0_mapper.py] as MapperUI
}

package "Mapper Core" {
  [TorqueMapper\nTorque_mapper.py] as TM
  [Compiler\ncompiler.py] as Compiler
  [Registry\nregistry.py] as Registry
  [Grammar Loader\ngrammar.py] as GrammarLoader
  [BNF File\nensamble_grammar.bnf] as GrammarFile
}

User - -> Browser : navigate to Torque
Browser - -> Home : load
Home - -> MapperUI : switch_page(\"0_mapper.py\")

Browser - -> MapperUI : enter Torque DSL\nclick \"Map to AST & Python\"
MapperUI - -> TM : map DSL
TM - -> GrammarLoader : get GRAMMAR_BNF
GrammarLoader - -> GrammarFile : read BNF
TM - -> Compiler : (for nested models)
TM - -> Registry : resolve model/ensemble classes
TM - -> MapperUI : AST + Python code

MapperUI - -> Browser : render AST tree,\nJSON and Python code

@enduml

PlantUML version 1.2021.00(Sun Jan 10 10:25:05 GMT 2021)
(MIT source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>